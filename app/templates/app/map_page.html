{% extends "base.html" %}

{% load humanize brand groundwork_geo wagtailsettings_tags account setting django_bootstrap5 wagtailcore_tags static wagtailroutablepage_tags django_bootstrap5 setting %}

{% block content_padding %}p-0{% endblock %}

{% block content_width %}container-fluid{% endblock %}

{% comment %} 

data-controller="list-filter"

For a filter:
  data-filter-attr="location-type"
  data-filter-value="in_person"
  data-action="click->list-filter#select"

For the items:
  data-location-type="virtual | in_person"

{% endcomment %}

{% block content %}
  <main class='tw-flex tw-flex-col md:tw-grid md:tw-grid-cols-5 md:tw-h-screen md:tw-overflow-x-visible'>
    <section
      class='tw-col-span-2 order-last md:order-first md:tw-overflow-y-auto tw-overflow-x-visible tw-border-r tw-border-r-black'
      data-controller="list-filter"
      data-list-filter-selected-value='{ "locationType": "__ALL__" }'
      data-list-filter-option-active-classes-value="tw-bg-yellow"
      data-list-filter-option-passive-classes-value="tw-bg-slate-300"
    >
      <article class="px-3 py-3">
        <h2>Find a reading group</h2>
        <p>
          Left Book Club isnâ€™t just about the books. We're building a network of reading groups, and we can help you get your own group off the ground.
        </p>
        {% bootstrap_button href=event.url content="Add your reading group" %}
      </article>
      <div class="tw-space-x-1 px-3 pb-3 tw-text-sm">
        <span>
          <span data-list-filter-target="count">0</span> events
        </span>
        <a
          data-list-filter-target="option"
          data-list-filter-value-param="__ALL__"
          data-list-filter-attr-param="locationType"
          data-action="click->list-filter#selectForAttr" 
          class="tw-cursor-pointer tw-text-no-underline tw-text-black tw-inline-block tw-py-1 tw-px-2 tw-rounded-lg tw-bg-slate-300 hover:tw-bg-slate-400">All</a>
        <a
          data-list-filter-target="option"
          data-list-filter-value-param="in_person"
          data-list-filter-attr-param="locationType"
          data-action="click->list-filter#selectForAttr" 
          class="tw-cursor-pointer tw-text-no-underline tw-text-black tw-inline-block tw-py-1 tw-px-2 tw-rounded-lg tw-bg-slate-300 hover:tw-bg-slate-400">In Person</a>
        <a
          data-list-filter-target="option"
          data-list-filter-value-param="virtual"
          data-list-filter-attr-param="locationType"
          data-action="click->list-filter#selectForAttr" 
          class="tw-cursor-pointer tw-text-no-underline tw-text-black tw-inline-block tw-py-1 tw-px-2 tw-rounded-lg tw-bg-slate-300 hover:tw-bg-slate-400">Online</a>
      </div>
      <ol class="tw-relative tw-list-none tw-p-3">
      {% for event in events %}
        <li
          data-list-filter-target="item"
          data-location-type="{{ event.location_type }}"
          class="{% brand_background_by_index forloop.counter "light" %} tw-px-3 tw-py-3 tw-mb-3">
            <div class='tw-space-x-1'>
              <span class="tw-mb-1 tw-text-sm tw-font-normal tw-leading-none tw-text-gray-800">{{event.starts_at|naturaltime}}</span>
              <span>&middot;</span>
              <time class="tw-mb-1 tw-text-sm tw-font-normal tw-leading-none tw-text-gray-800">{{ event.starts_at|date:"P l jS M" }}</time>
              <span>&middot;</span>
              <span class="tw-mb-1 tw-text-sm tw-font-normal tw-leading-none tw-text-gray-800 tw-capitalize">{{ event.location_type|replace:"_| " }}</span>
            </div>
            <h3 class="tw-text-lg tw-font-semibold tw-text-gray-900">{{ event.name }}</h3>
            {% if event.body.body %}
              {{ event.body.body|safe }}
            {% endif %}
            <br />
            {% bootstrap_button href=event.url content="Learn more" %}
        </li>
      {% endfor %}
      </ol>
    </section>
    <section class='tw-h-[250px] md:tw-h-auto md:tw-col-span-3 tw-relative'>
      {% map class='tw-h-full tw-w-full tw-absolute tw-top-0 tw-left-0' center="[ -2.5, 53.6]" zoom=5.5 style="mapbox://styles/commonknowledge/cl7cnn4d6004a14nzcmvf0k01/draft" %}
        {% for id, data in sources.items %}
          {% adjusted_map_source id=id data=data %}
        {% endfor %}
      
        {% for id, layer in layers.items %}
          {% adjusted_map_layer id=id layer=layer %}
        {% endfor %}
      {% endmap %}
    </section>
  </main>
{% endblock %}
